{"version":3,"sources":["api/api.ts","api/BA.ts","components/PostsList/PostsList.tsx","components/NewCommentForm/NewCommentForm.tsx","components/PostDetails/PostDetails.tsx","api/comments.ts","api/posts.ts","App.tsx","index.tsx"],"names":["allPostEndpoint","request","url","options","fetch","then","response","ok","Error","status","statusText","json","PostsList","currentId","openPost","useState","posts","setPosts","useEffect","user","selectEndpoint","getUserPosts","res","className","map","el","userId","title","type","onClick","e","event","element","target","nativeEvent","classList","contains","remove","innerText","allButton","Array","from","document","querySelectorAll","forEach","item","textContent","add","id","changeButtonActive","NewCommentForm","postId","newListComments","name","setName","email","setEmail","body","setBody","nameUncorrect","setNameUncorrect","emailUncorrect","setEmailUncorrect","bodyEmpty","setBodyEmpty","showError","changeState","hideError","onChangeInput","dataChange","value","submitNewComment","data","preventDefault","method","headers","JSON","stringify","onSubmit","placeholder","onChange","onBlur","RegExp","test","includes","length","PostDetails","selectedPostId","selectedPost","setSelectedPost","postComments","setPostComments","visibleComments","setVisibleComments","useCallback","endpoint","getPostComments","removeComment","getPostDetails","disabled","prev","changeVisibleComments","App","visibleUsers","setVisibleUsers","currentSelect","setCurrentSelect","setSelectedPostId","getUsers","slice","htmlFor","idPost","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.5c887c1c.chunk.js","sourcesContent":["export const BASE_URL = 'https://mate.academy/students-api';\nexport const allPostEndpoint = '/posts';\n","import { BASE_URL, allPostEndpoint } from './api';\nimport { Comment } from '../types/Comment';\n\nexport const request = (url: string, options?: {\n  method: string, headers?: any, body?: string\n}) => {\n  return fetch(`${BASE_URL}${url}`, options)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(`${response.status}-${response.statusText}`);\n      }\n\n      return response.json();\n    });\n};\n\nexport const removeFromServer = (url: string) => {\n  return request(url, { method: 'DELETE' });\n};\n\nexport const addComment = (url: string, data: Comment) => {\n  return request(url, {\n    method: 'POST',\n    headers: {\n      'Content-type': 'application/json; charset=UTF-8',\n    },\n    body: JSON.stringify(data),\n  });\n};\n\nexport const getUserPosts = (user: number) => {\n  const selectEndpoint = (user !== 0)\n    ? `${allPostEndpoint}?userId=${user}`\n    : allPostEndpoint;\n\n  return request(selectEndpoint);\n};\n\nexport const getUsers = (name?: string | undefined) => {\n  const selectEndpoint = (name)\n    ? `/users?username=${name}`\n    : '/users';\n\n  return request(selectEndpoint);\n};\n","import React, { useEffect, useState } from 'react';\nimport './PostsList.scss';\nimport { getUserPosts } from '../../api/BA';\nimport { Post } from '../../types/Post';\n\ntype Props = {\n  currentId: number,\n  openPost: (idPost: number | null) => void,\n};\n\nexport const PostsList: React.FC<Props> = ({ currentId, openPost }) => {\n  const [posts, setPosts] = useState<Post[]>([]);\n\n  useEffect(() => {\n    getUserPosts(currentId)\n      .then(res => setPosts(res));\n  }, [currentId]);\n\n  const changeButtonActive = (event: React.MouseEvent<Element>, element:Post) => {\n    const target = event.nativeEvent.target as HTMLButtonElement;\n\n    if (target.classList.contains('button--active')) {\n      openPost(null);\n      target.classList.remove('button--active');\n      target.innerText = 'Open';\n    } else {\n      const allButton = Array.from(document.querySelectorAll('.PostsList__button'));\n\n      [...allButton].forEach(item => {\n        item.classList.remove('button--active');\n        const button = item;\n\n        button.textContent = 'Open';\n      });\n      target.classList.add('button--active');\n      target.innerText = 'Close';\n      openPost(element.id);\n    }\n  };\n\n  return (\n    <div className=\"PostsList\">\n      <h2>Posts:</h2>\n\n      <ul className=\"PostsList__list\">\n        {posts.map(el => (\n          <li className=\"PostsList__item\" key={el.id}>\n            <div>\n              <b>\n                {`[User #${el.userId}]: `}\n              </b>\n              {el.title}\n            </div>\n            <button\n              type=\"button\"\n              className=\"PostsList__button button\"\n              onClick={(e: React.MouseEvent<Element>) => changeButtonActive(e, el)}\n            >\n              Open\n            </button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport './NewCommentForm.scss';\nimport { addComment } from '../../api/BA';\n\ntype Props = {\n  postId: number | undefined,\n  newListComments: () => void,\n};\n\nexport const NewCommentForm: React.FC<Props> = ({ postId, newListComments }) => {\n  const [name, setName] = useState<string>('');\n  const [email, setEmail] = useState('');\n  const [body, setBody] = useState('');\n  const [nameUncorrect, setNameUncorrect] = useState(false);\n  const [emailUncorrect, setEmailUncorrect] = useState(false);\n  const [bodyEmpty, setBodyEmpty] = useState(false);\n\n  const showError = (changeState: React.Dispatch<React.SetStateAction<boolean>>) => {\n    changeState(true);\n  };\n\n  const hideError = (changeState: React.Dispatch<React.SetStateAction<boolean>>) => {\n    changeState(false);\n  };\n\n  const onChangeInput = (\n    event: React.ChangeEvent<HTMLInputElement> | React.ChangeEvent<HTMLTextAreaElement>,\n    dataChange: (n: string) => void,\n  ) => {\n    const { value } = event.target;\n\n    dataChange(value);\n  };\n\n  const submitNewComment = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    if (!nameUncorrect && !emailUncorrect && !bodyEmpty && name && body && email) {\n      addComment('/comments', {\n        postId,\n        name,\n        email,\n        body,\n      })\n        .then(() => newListComments());\n    }\n\n    setName('');\n    setEmail('');\n    setBody('');\n  };\n\n  const onInputName = () => {\n    const regex = new RegExp('^[a-zA-Zа-яА-ЯёЁіІїЇ\\']+$');\n\n    if (!regex.test(name)) {\n      showError(setNameUncorrect);\n    } else {\n      hideError(setNameUncorrect);\n    }\n  };\n\n  const onInputMail = () => {\n    return (!email.includes('@'))\n      ? showError(setEmailUncorrect)\n      : hideError(setEmailUncorrect);\n  };\n\n  const onInputText = () => {\n    return (body.length < 3)\n      ? showError(setBodyEmpty)\n      : hideError(setBodyEmpty);\n  };\n\n  return (\n    <form\n      className=\"NewCommentForm\"\n      onSubmit={(e) => submitNewComment(e)}\n    >\n      <div className=\"form-field\">\n        {nameUncorrect && <p className=\"NewCommentForm__input-error\">Please input correct name</p>}\n        <input\n          type=\"text\"\n          name=\"name\"\n          value={name}\n          placeholder=\"Your name\"\n          className=\"NewCommentForm__input\"\n          onChange={(e) => onChangeInput(e, setName)}\n          onBlur={() => onInputName()}\n        />\n      </div>\n      <div className=\"form-field\">\n        {emailUncorrect && <p className=\"NewCommentForm__input-error\">Please input correct email</p>}\n        <input\n          type=\"text\"\n          name=\"email\"\n          value={email}\n          placeholder=\"Your email\"\n          className=\"NewCommentForm__input\"\n          onChange={(e) => onChangeInput(e, setEmail)}\n          onBlur={() => onInputMail()}\n        />\n      </div>\n\n      <div className=\"form-field\">\n        {bodyEmpty && <p className=\"NewCommentForm__input-error\">Please input your comment</p>}\n        <textarea\n          name=\"body\"\n          value={body}\n          placeholder=\"Type comment here\"\n          className=\"NewCommentForm__input\"\n          onChange={(e) => onChangeInput(e, setBody)}\n          onBlur={() => onInputText()}\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        className=\"NewCommentForm__submit-button button\"\n      >\n        Add a comment\n      </button>\n    </form>\n  );\n};\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { NewCommentForm } from '../NewCommentForm';\nimport './PostDetails.scss';\nimport { Post } from '../../types/Post';\nimport { Comment } from '../../types/Comment';\nimport { getPostDetails } from '../../api/posts';\nimport { getPostComments } from '../../api/comments';\nimport { removeFromServer } from '../../api/BA';\n\ntype Props = {\n  selectedPostId: number\n};\n\nexport const PostDetails: React.FC<Props> = ({ selectedPostId }) => {\n  const [selectedPost, setSelectedPost] = useState<Post>();\n  const [postComments, setPostComments] = useState<Comment[]>([]);\n  const [visibleComments, setVisibleComments] = useState<boolean>(false);\n\n  const newListComments = useCallback(() => {\n    getPostComments(selectedPostId)\n      .then(res => setPostComments(res));\n  }, [selectedPostId]);\n\n  const removeComment = useCallback((element) => {\n    removeFromServer(`/comments/${element.id}`)\n      .then(() => newListComments());\n  }, [selectedPostId]);\n\n  useEffect(() => {\n    getPostDetails(selectedPostId)\n      .then(res => setSelectedPost(res));\n  }, [selectedPostId]);\n\n  useEffect(() => {\n    newListComments();\n  }, [selectedPostId]);\n\n  const changeVisibleComments = (event: React.MouseEvent<Element>) => {\n    const target = event.target as HTMLButtonElement;\n\n    if (visibleComments) {\n      target.innerText = `Show ${postComments.length} comments`;\n      setVisibleComments(prev => !prev);\n    } else {\n      target.innerText = ` Hide ${postComments.length} comments`;\n      setVisibleComments(prev => !prev);\n    }\n  };\n\n  return (\n    <div className=\"PostDetails\">\n      <h2>Post details:</h2>\n      <section className=\"PostDetails__post\">\n        <p>{selectedPost?.body}</p>\n      </section>\n      <section className=\"PostDetails__comments\">\n        <button\n          type=\"button\"\n          className=\"PostDetails__button button\"\n          disabled={postComments.length === 0}\n          onClick={(e) => {\n            changeVisibleComments(e);\n          }}\n        >\n          {` Show ${postComments.length} comments`}\n        </button>\n        {visibleComments\n        && (\n          <ul className=\"PostDetails__list\">\n            {postComments.map(el => (\n              <li\n                className=\"PostDetails__list-item\"\n                key={el.id}\n              >\n                <button\n                  type=\"button\"\n                  className=\"PostDetails__remove-button button\"\n                  onClick={() => {\n                    removeComment(el);\n                  }}\n                >\n                  X\n                </button>\n                <p>{el.body}</p>\n              </li>\n            ))}\n          </ul>\n        )}\n      </section>\n\n      <section>\n        <div className=\"PostDetails__form-wrapper\">\n          <NewCommentForm postId={selectedPost?.id} newListComments={newListComments} />\n        </div>\n      </section>\n    </div>\n  );\n};\n","import { request } from './BA';\n\nexport const getPostComments = (postId: number) => {\n  const endpoint = `/comments?postId=${postId}`;\n\n  return request(endpoint);\n};\n","import { request } from './BA';\n\nexport const getPostDetails = (postId: number) => {\n  const endpoint = `/posts/${postId}`;\n\n  return request(endpoint);\n};\n","import React, { useState, useEffect } from 'react';\nimport './App.scss';\nimport './styles/general.scss';\nimport { PostsList } from './components/PostsList';\nimport { PostDetails } from './components/PostDetails';\nimport { getUsers } from './api/BA';\n\ntype User = {\n  id: number,\n  name: string,\n  username: string,\n};\n\nconst App: React.FC = () => {\n  const [visibleUsers, setVisibleUsers] = useState<User[]>([]);\n  const [currentSelect, setCurrentSelect] = useState<number>(0);\n  const [selectedPostId, setSelectedPostId] = useState<number | null>(null);\n\n  useEffect(() => {\n    getUsers()\n      .then(res => setVisibleUsers(res.slice(0, 10)));\n  }, []);\n\n  const openPost = (idPost:number | null) => {\n    setSelectedPostId(idPost);\n  };\n\n  return (\n    <div className=\"App\">\n      <header className=\"App__header\">\n        <label htmlFor=\"selectUsers\">\n          Select a user: &nbsp;\n\n          <select\n            className=\"App__user-selector\"\n            id=\"selectUsers\"\n            onChange={(e) => setCurrentSelect(+e.target.value)}\n          >\n            <option value={0}>All users</option>\n            {visibleUsers.map(el => (\n              <option\n                value={el.id}\n                key={el.id}\n              >\n                {el.name}\n              </option>\n            ))}\n          </select>\n        </label>\n      </header>\n\n      <main className=\"App__main\">\n        <div className=\"App__sidebar\">\n          <PostsList\n            currentId={currentSelect}\n            openPost={openPost}\n          />\n        </div>\n\n        <div className=\"App__content\">\n          {selectedPostId && <PostDetails selectedPostId={selectedPostId} />}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default App;\n","import ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}