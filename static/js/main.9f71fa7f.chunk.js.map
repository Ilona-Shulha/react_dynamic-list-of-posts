{"version":3,"sources":["api/api.ts","api/BA.ts","components/PostsList/PostsList.tsx","components/NewCommentForm/NewCommentForm.tsx","components/PostDetails/PostDetails.tsx","api/comments.ts","api/posts.ts","App.tsx","index.tsx"],"names":["allPostEndpoint","request","url","options","fetch","then","response","ok","Error","status","statusText","json","getUserPosts","user","selectEndpoint","PostsList","currentId","openPost","useState","posts","setPosts","useEffect","res","className","map","el","userId","title","type","onClick","e","target","nativeEvent","classList","contains","remove","innerText","allButton","Array","from","document","querySelectorAll","forEach","item","textContent","add","id","NewCommentForm","postId","newListComments","name","setName","email","setEmail","body","setBody","nameUncorrect","setNameUncorrect","emailUncorrect","setEmailUncorrect","bodyEmpty","setBodyEmpty","showError","changeState","hideError","onSubmit","data","preventDefault","method","headers","JSON","stringify","value","placeholder","onChange","trim","onBlur","RegExp","test","includes","length","PostDetails","selectedPostId","selectedPost","setSelectedPost","postComments","setPostComments","visibleComments","setVisibleComments","endpoint","getPostComments","getPostDetails","disabled","prev","App","visibleUsers","setVisibleUsers","currentSelect","setCurrentSelect","setSelectedPostId","getUsers","slice","htmlFor","idPost","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.9f71fa7f.chunk.js","sourcesContent":["export const BASE_URL = 'https://mate.academy/students-api';\nexport const allPostEndpoint = '/posts';\n","import { BASE_URL, allPostEndpoint } from './api';\nimport { Comment } from '../types/Comment';\n\nexport const request = (url: string, options?: {\n  method: string, headers?: any, body?: string\n}) => {\n  return fetch(`${BASE_URL}${url}`, options)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(`${response.status}-${response.statusText}`);\n      }\n\n      return response.json();\n    });\n};\n\nexport const removeFromServer = (url: string) => {\n  return request(url, { method: 'DELETE' });\n};\n\nexport const addComment = (url: string, data: Comment) => {\n  return request(url, {\n    method: 'POST',\n    headers: {\n      'Content-type': 'application/json; charset=UTF-8',\n    },\n    body: JSON.stringify(data),\n  });\n};\n\nexport const getUserPosts = (user: number) => {\n  const selectEndpoint = (user !== 0)\n    ? `${allPostEndpoint}?userId=${user}`\n    : allPostEndpoint;\n\n  return request(selectEndpoint);\n};\n\nexport const getUsers = (name?: string | undefined) => {\n  const selectEndpoint = (name)\n    ? `/users?username=${name}`\n    : '/users';\n\n  return request(selectEndpoint);\n};\n","import React, { useEffect, useState } from 'react';\nimport './PostsList.scss';\nimport { getUserPosts } from '../../api/BA';\nimport { Post } from '../../types/Post';\n\ntype Props = {\n  currentId: number,\n  openPost:any,\n};\n\nexport const PostsList: React.FC<Props> = ({ currentId, openPost }) => {\n  const [posts, setPosts] = useState<Post[]>([]);\n\n  useEffect(() => {\n    getUserPosts(currentId)\n      .then(res => setPosts(res));\n  }, []);\n\n  useEffect(() => {\n    getUserPosts(currentId)\n      .then(res => setPosts(res));\n  }, [currentId]);\n\n  return (\n    <div className=\"PostsList\">\n      <h2>Posts:</h2>\n\n      <ul className=\"PostsList__list\">\n        {posts.map(el => (\n          <li className=\"PostsList__item\" key={el.id}>\n            <div>\n              <b>\n                {`[User #${el.userId}]: `}\n              </b>\n              {el.title}\n            </div>\n            <button\n              type=\"button\"\n              className=\"PostsList__button button\"\n              onClick={(e) => {\n                const target = e.nativeEvent.target as HTMLButtonElement;\n\n                if (target.classList.contains('button--active')) {\n                  openPost(0);\n                  target.classList.remove('button--active');\n                  target.innerText = 'Open';\n                } else {\n                  const allButton = Array.from(document.querySelectorAll('.PostsList__button'));\n\n                  [...allButton].forEach(item => {\n                    item.classList.remove('button--active');\n                    const button = item;\n\n                    button.textContent = 'Open';\n                  });\n                  target.classList.add('button--active');\n                  target.innerText = 'Close';\n                  openPost(el.id);\n                }\n              }}\n            >\n              Open\n            </button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport './NewCommentForm.scss';\nimport { addComment } from '../../api/BA';\n\ntype Props = {\n  postId: number | undefined,\n  newListComments: () => void,\n};\n\nexport const NewCommentForm: React.FC<Props> = ({ postId, newListComments }) => {\n  const [name, setName] = useState<string>('');\n  const [email, setEmail] = useState('');\n  const [body, setBody] = useState('');\n  const [nameUncorrect, setNameUncorrect] = useState(false);\n  const [emailUncorrect, setEmailUncorrect] = useState(false);\n  const [bodyEmpty, setBodyEmpty] = useState(false);\n\n  const showError = (changeState: any) => {\n    changeState(true);\n  };\n\n  const hideError = (changeState: any) => {\n    changeState(false);\n  };\n\n  return (\n    <form\n      className=\"NewCommentForm\"\n      onSubmit={(e) => {\n        e.preventDefault();\n        if (!nameUncorrect && !emailUncorrect && !bodyEmpty && name && body && email) {\n          addComment('/comments', {\n            postId,\n            name,\n            email,\n            body,\n          })\n            .then(() => newListComments());\n        }\n      }}\n    >\n      <div className=\"form-field\">\n        {nameUncorrect && <p className=\"NewCommentForm__input-error\">Please input correct name</p>}\n        <input\n          type=\"text\"\n          name=\"name\"\n          value={name}\n          placeholder=\"Your name\"\n          className=\"NewCommentForm__input\"\n          onChange={(e) => {\n            const { value } = e.target;\n\n            setName(value.trim());\n          }}\n          onBlur={() => {\n            const regex = new RegExp('^[a-zA-Zа-яА-ЯёЁ\\'][a-zA-Z-а-яА-ЯёЁ\\'][a-zA-Zа-яА-ЯёЁ\\']?$');\n\n            if (!regex.test(name)) {\n              showError(setNameUncorrect);\n            } else {\n              hideError(setNameUncorrect);\n            }\n          }}\n        />\n      </div>\n      <div className=\"form-field\">\n        {emailUncorrect && <p className=\"NewCommentForm__input-error\">Please input correct email</p>}\n        <input\n          type=\"text\"\n          name=\"email\"\n          value={email}\n          placeholder=\"Your email\"\n          className=\"NewCommentForm__input\"\n          onChange={(e) => {\n            const { value } = e.target;\n\n            setEmail(value.trim());\n          }}\n          onBlur={() => {\n            if (!email.includes('@')) {\n              showError(setEmailUncorrect);\n            } else {\n              hideError(setEmailUncorrect);\n            }\n          }}\n        />\n      </div>\n\n      <div className=\"form-field\">\n        {bodyEmpty && <p className=\"NewCommentForm__input-error\">Please input your comment</p>}\n        <textarea\n          name=\"body\"\n          value={body}\n          placeholder=\"Type comment here\"\n          className=\"NewCommentForm__input\"\n          onChange={(e) => {\n            const { value } = e.target;\n\n            setBody(value);\n          }}\n          onBlur={() => {\n            if (body.length < 3) {\n              showError(setBodyEmpty);\n            } else {\n              hideError(setBodyEmpty);\n            }\n          }}\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        className=\"NewCommentForm__submit-button button\"\n      >\n        Add a comment\n      </button>\n    </form>\n  );\n};\n","import React, { useEffect, useState } from 'react';\nimport { NewCommentForm } from '../NewCommentForm';\nimport './PostDetails.scss';\nimport { Post } from '../../types/Post';\nimport { Comment } from '../../types/Comment';\nimport { getPostDetails } from '../../api/posts';\nimport { getPostComments } from '../../api/comments';\nimport { removeFromServer } from '../../api/BA';\n\ntype Props = {\n  selectedPostId: number\n};\n\nexport const PostDetails: React.FC<Props> = ({ selectedPostId }) => {\n  const [selectedPost, setSelectedPost] = useState<Post>();\n  const [postComments, setPostComments] = useState<Comment[]>([]);\n  const [visibleComments, setVisibleComments] = useState<boolean>(false);\n\n  const newListComments = () => {\n    getPostComments(selectedPostId)\n      .then(res => setPostComments(res));\n  };\n\n  useEffect(() => {\n    getPostDetails(selectedPostId)\n      .then(res => setSelectedPost(res));\n  }, [selectedPostId]);\n\n  useEffect(() => {\n    newListComments();\n  }, [selectedPostId]);\n\n  return (\n    <div className=\"PostDetails\">\n      <h2>Post details:</h2>\n      <section className=\"PostDetails__post\">\n        <p>{selectedPost?.body}</p>\n      </section>\n      <section className=\"PostDetails__comments\">\n        <button\n          type=\"button\"\n          className=\"PostDetails__button button\"\n          disabled={postComments.length === 0}\n          onClick={(e) => {\n            const target = e.target as HTMLButtonElement;\n\n            if (visibleComments) {\n              target.innerText = `Show ${postComments.length} comments`;\n              setVisibleComments(prev => !prev);\n            } else {\n              target.innerText = ` Hide ${postComments.length} comments`;\n              setVisibleComments(prev => !prev);\n            }\n          }}\n        >\n          {` Show ${postComments.length} comments`}\n        </button>\n        {visibleComments\n        && (\n          <ul className=\"PostDetails__list\">\n            {postComments.map(el => (\n              <li\n                className=\"PostDetails__list-item\"\n                key={el.id}\n              >\n                <button\n                  type=\"button\"\n                  className=\"PostDetails__remove-button button\"\n                  onClick={() => {\n                    removeFromServer(`/comments/${el.id}`)\n                      .then(() => newListComments());\n                  }}\n                >\n                  X\n                </button>\n                <p>{el.body}</p>\n              </li>\n            ))}\n          </ul>\n        )}\n      </section>\n\n      <section>\n        <div className=\"PostDetails__form-wrapper\">\n          <NewCommentForm postId={selectedPost?.id} newListComments={newListComments} />\n        </div>\n      </section>\n    </div>\n  );\n};\n","import { request } from './BA';\n\nexport const getPostComments = (postId: number) => {\n  const endpoint = `/comments?postId=${postId}`;\n\n  return request(endpoint);\n};\n","import { request } from './BA';\n\nexport const getPostDetails = (postId: number) => {\n  const endpoint = `/posts/${postId}`;\n\n  return request(endpoint);\n};\n","import React, { useState, useEffect } from 'react';\nimport './App.scss';\nimport './styles/general.scss';\nimport { PostsList } from './components/PostsList';\nimport { PostDetails } from './components/PostDetails';\nimport { getUsers } from './api/BA';\n\ntype User = {\n  id: number,\n  name: string,\n  username: string,\n};\n\nconst App: React.FC = () => {\n  const [visibleUsers, setVisibleUsers] = useState<User[]>([]);\n  const [currentSelect, setCurrentSelect] = useState<number>(0);\n  const [selectedPostId, setSelectedPostId] = useState<number>(0);\n\n  useEffect(() => {\n    getUsers()\n      .then(res => setVisibleUsers(res.slice(0, 10)));\n  }, []);\n\n  const openPost = (idPost:number) => {\n    setSelectedPostId(idPost);\n  };\n\n  return (\n    <div className=\"App\">\n      <header className=\"App__header\">\n        <label htmlFor=\"selectUsers\">\n          Select a user: &nbsp;\n\n          <select\n            className=\"App__user-selector\"\n            id=\"selectUsers\"\n            onChange={(e) => setCurrentSelect(+e.target.value)}\n          >\n            <option value={0}>All users</option>\n            {visibleUsers.map(el => (\n              <option\n                value={el.id}\n                key={el.id}\n              >\n                {el.name}\n              </option>\n            ))}\n          </select>\n        </label>\n      </header>\n\n      <main className=\"App__main\">\n        <div className=\"App__sidebar\">\n          <PostsList\n            currentId={currentSelect}\n            openPost={openPost}\n          />\n        </div>\n\n        <div className=\"App__content\">\n          {(selectedPostId !== 0) && <PostDetails selectedPostId={selectedPostId} />}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default App;\n","import ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}